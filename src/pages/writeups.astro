---
import BaseLayout from '../layouts/BaseLayout.astro';
import Navbar from '../components/Navbar.astro';
import { writeups } from '../content/writeups.js';
---

<BaseLayout title="Writeups - Mon Portfolio">
  <Navbar />
  
  <main class="min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900 py-12 px-4">
    <div class="max-w-7xl mx-auto">
      
      <!-- Header -->
      <div class="mb-12">
        <h1 class="text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-green-400 via-emerald-500 to-teal-600 mb-4">
          $ ls /Writeups
        </h1>
        <p class="text-gray-400 text-lg">My detailed writeups of CTF challenges and machines</p>
      </div>

      <!-- Grid des writeups -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        {writeups.map((w, index) => {
          // Couleurs en fonction de la plateforme
          let color;
          if (w.platform.toLowerCase().includes('hackthebox') || w.platform.toLowerCase().includes('htb')) {
            color = { border: 'border-green-500/30', hover: 'hover:border-green-500/60', shadow: 'hover:shadow-green-500/20', text: 'text-green-400', bg: 'bg-green-500/20', gradient: 'from-green-500/5', badge: 'bg-green-500/20 border-green-500/30' };
          } else if (w.platform.toLowerCase().includes('tryhackme') || w.platform.toLowerCase().includes('thm')) {
            color = { border: 'border-red-500/30', hover: 'hover:border-red-500/60', shadow: 'hover:shadow-red-500/20', text: 'text-red-400', bg: 'bg-red-500/20', gradient: 'from-red-500/5', badge: 'bg-red-500/20 border-red-500/30' };
          } else if (w.platform.toLowerCase().includes('ctf')) {
            color = { border: 'border-purple-500/30', hover: 'hover:border-purple-500/60', shadow: 'hover:shadow-purple-500/20', text: 'text-purple-400', bg: 'bg-purple-500/20', gradient: 'from-purple-500/5', badge: 'bg-purple-500/20 border-purple-500/30' };
          } else {
            color = { border: 'border-blue-500/30', hover: 'hover:border-blue-500/60', shadow: 'hover:shadow-blue-500/20', text: 'text-blue-400', bg: 'bg-blue-500/20', gradient: 'from-blue-500/5', badge: 'bg-blue-500/20 border-blue-500/30' };
          }
          
          return (
            <div class={`group relative bg-gradient-to-br from-gray-800/50 to-gray-900/50 backdrop-blur-sm border ${color.border} rounded-2xl p-8 ${color.hover} transition-all duration-300 hover:shadow-2xl ${color.shadow} hover:-translate-y-1`}>
              <div class={`absolute inset-0 bg-gradient-to-br ${color.gradient} to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity`}></div>
              
              <div class="relative">
                <!-- Icône + Badge Plateforme -->
                <div class="flex items-start justify-between mb-6">
                  <div class={`w-14 h-14 ${color.bg} rounded-xl flex items-center justify-center`}>
                    <svg class={`w-8 h-8 ${color.text}`} fill="currentColor" viewBox="0 0 24 24">
                      <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/>
                    </svg>
                  </div>
                  
                  <span class={`px-4 py-2 ${color.badge} ${color.text} text-sm font-bold rounded-full border`}>
                    {w.platform}
                  </span>
                </div>

                <!-- Titre -->
                <h2 class="text-xl font-bold text-white mb-6 leading-relaxed group-hover:text-transparent group-hover:bg-clip-text group-hover:bg-gradient-to-r group-hover:from-white group-hover:to-gray-300 transition-all">
                  {w.title}
                </h2>

                <!-- Tags si présents dans le titre -->
                {w.title.match(/\((.*?)\)/)?.[1] && (
                  <div class="flex flex-wrap gap-2 mb-6">
                    {w.title.match(/\((.*?)\)/)[1].split(',').map(tag => (
                      <span class="px-3 py-1 bg-white/10 text-gray-300 text-xs rounded-full border border-white/20">
                        {tag.trim()}
                      </span>
                    ))}
                  </div>
                )}

                <!-- Lien -->
                <a href={w.link}
                   class={`inline-flex items-center gap-2 ${color.text} text-lg font-semibold hover:opacity-80 transition-opacity group/link`}>
                  <span>Check writeup</span>
                  <svg class="w-5 h-5 group-hover/link:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
                  </svg>
                </a>
              </div>
            </div>
          );
        })}
      </div>

      <!-- Message si aucun writeup -->
      {writeups.length === 0 && (
        <div class="text-center py-20">
          <svg class="w-20 h-20 text-gray-600 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
          </svg>
          <p class="text-gray-400 text-xl">No writeups yet</p>
        </div>
      )}

    </div>
  </main>
</BaseLayout>